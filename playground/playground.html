<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Endless Fibonacci Spiral</title>
    <style>
		body {
			margin: 0;
			overflow: hidden;
			background-color: black;
		}
		canvas {
			display: block;
		}
    </style>
</head>
<body>
<canvas id="blackHoleCanvas"></canvas>

<script>
    const canvas = document.getElementById('blackHoleCanvas');
    const ctx = canvas.getContext('2d');

    // Set canvas dimensions
    function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    resizeCanvas();

    // Center of canvas
    let centerX = canvas.width / 2;
    let centerY = canvas.height / 2;

    // Update center on resize
    window.addEventListener('resize', () => {
        resizeCanvas();
        centerX = canvas.width / 2;
        centerY = canvas.height / 2;
    });

    // Spiral parameters
    let angle = 0;
    let scale = 0.0069; // Reduced scale to make spiral smaller
    let speed = 0.0069; // Slow rotation speed
    let points = []; // Stores current visible points
    let fib1 = 1, fib2 = 1; // Starting Fibonacci numbers
    let totalPoints = 0; // Counter to keep track of points generated

    // Colors for gradient effect
    const colors = [
        "black", "#791f0d", "#a47971", "#a8a4a3", "#a92d14"
    ];

    // Generate next Fibonacci number
    function nextFibonacci() {
        const next = fib1 + fib2;
        fib1 = fib2;
        fib2 = next;
        return next;
    }
    const distPadding = 7;

    // Draw spiral
    function drawFibonacciSpiral() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.save();
        ctx.translate(centerX, centerY); // Move origin to the center
        ctx.rotate(angle); // Rotate for dynamic effect

        // Draw each point in the points array
        points.forEach((point) => {
            const { x, y, r, color, opacity } = point;

            // Draw a circle with color and depth effect
            ctx.beginPath();
            ctx.arc(x, y, r, 0, Math.PI * 2);
            ctx.fillStyle = `rgba(${hexToRgb(color)}, ${opacity})`;
            ctx.fill();

            // Update point position (simulate movement outward)
            point.r *= 1.0069; // Slight increase in size
            point.x = distPadding * point.r * Math.cos(point.angle);
            point.y = distPadding * point.r * Math.sin(point.angle);
            if (point.opacity < 0.69) {
                point.opacity += 0.005; // Slowly fade out
            } else {
                point.opacity -= 0.095;
            }
        });

        // Remove points that are out of view or fully transparent
        points = points.filter(point => point.r < canvas.width * 1.5 && point.opacity > 0);

        // Generate new Fibonacci point
        const fibRadius = nextFibonacci() * scale * 200; // Increase scale for larger distance
        const angleOffset = totalPoints * 0.5; // Increase this for more spacing between points

        const colorIndex = totalPoints % colors.length;
        const color = colors[colorIndex];

        const newPoint = {
            x: fibRadius * Math.cos(angleOffset),
            y: fibRadius * Math.sin(angleOffset),
            r: 5, // Keep the circles small but visible
            color: color, // Use valid color
            opacity: 0.05, // Full opacity initially
            angle: angleOffset
        };

        // Add new point to the list
        points.push(newPoint);

        totalPoints++; // Increment the total points counter

        ctx.restore();

        // Increase angle slightly for smooth rotation
        angle += speed;

        // Loop the drawing
        requestAnimationFrame(drawFibonacciSpiral);
    }

    // Helper function to convert hex colors to RGB
    function hexToRgb(hex) {
        if (!hex) {
            return "0,0,0"; // Fallback to black if color is undefined
        }
        const bigint = parseInt(hex.slice(1), 16);
        const r = (bigint >> 16) & 255;
        const g = (bigint >> 8) & 255;
        const b = bigint & 255;
        return `${r},${g},${b}`;
    }

    drawFibonacciSpiral();

</script>
</body>
</html>
